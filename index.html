<!DOCTYPE html>
<html>
    <head>
        <title>password generator</title>
        <meta name="viewport" content="width=device-width,initial-scale=1">
        <style>
            body{
            padding: 10px;
            background: #ffffff;
            color: #444;
            }
            h1,h2 {
            color: #7cd0f2;
            }
            h1,h2,p,.checkbox {
            text-align: center;
            }
            hr {
            width:60%;
            max-width: 450px;
            }
            input {
            width: 90px;
            font-size: 20px;
            box-sizing: border-box;
            margin: 0.7em 0;
            padding: .8em;
            border-radius: 2em;
            border: 2px solid #aaa;
            }

            #generation-password {
            color: #7cd0f2;
            font-size: 50px;
            overflow-wrap: break-word;
            }
            .gene-btn {
            margin: 50px auto;
            width: auto;
            height: auto;
            max-width: 350px;
            border: 2px solid #aaa;
            text-align: center;
            color: #fff;
            padding:  40px 0;
            box-sizing: border-box;
            font-size: 50px;
            border-radius: 20px;
            background: #7cd0f2;
            }

            .gene-btn:hover {
            cursor: pointer;
            opacity: 0.7;
            }
            /* スマホ用設定 */
            @media screen and (max-width: 380px){
            h1 {
            font-size: 8vw;
            }
            #generation-password, .gene-btn {
            font-size: 13vw;
            }
            }
        </style>
    </head>
    <body>
        <h1>パスワード作成ツール</h1>
        <p>パスワードを自動生成してくれます</p>
        <p>英小文字、英大文字、数字を必ず含めます</p>
        <p id="generation-password">password</p>
        <div class="gene-btn" onclick="generation()">生成</div>

        <h2>設定</h2>
        <hr>
        <form class="checkbox" name="settings">
            <p>
                文字数：
                <input type="number" min="3" max="100" value="10" inputmode="numeric" id="pas-len">
            </p>
            <!-- <input type="checkbox" id="small_alphabets">英小文字<br>
            <input type="checkbox" id="large_alphabets">英大文字<br>
            <input type="checkbox" id="number">数字<br> -->
        </form>
    </body>
    <script>
        //要素取得
        const passwordGeneration = document.getElementById("generation-password");
        const passwordLength = document.getElementById("pas-len");

        const small_alphabets = "abcdefghijklmnopqrstuvwxyz";
        const large_alphabets = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
        const number = "0123456789"

        const shuffleArray = (array) => {
            const cloneArray = [...array]

            for (let i = cloneArray.length - 1; i >= 0; i--) {
                let rand = Math.floor(Math.random() * (i + 1))
                // 配列の要素の順番を入れ替える
                let tmpStorage = cloneArray[i]
                cloneArray[i] = cloneArray[rand]
                cloneArray[rand] = tmpStorage
            }

            return cloneArray
        }

        // パスワード生成
        function generation(){
            let character = ""
            // character = useCharacter();
            character += small_alphabets
            character += large_alphabets
            character += number
            character_array = shuffleArray(character);
            const conditions = "/[a-z][A-Z][0-9]/"
            
            try {
                do {
                    var password = ""
                    for (let step = 0; step < passwordLength.value; step++) {
                        const nmb = Math.floor(Math.random() * character_array.length);
                        password += character_array[nmb]
                    }
                } while(password.search(/[a-z][A-Z][0-9]/) == -1);
            } catch (error) {
                alert("生成エラー");
            }

            password = shuffleArray(password)

            passwordGeneration.textContent = password.join("");
        }
        function useCharacter() {
            useCha = ""
            if (document.getElementById("small_alphabets").checked) {
                useCha += small_alphabets
            }
            if (document.getElementById("large_alphabets").checked) {
                useCha += large_alphabets
            }
            if (document.getElementById("number").checked) {
                useCha += number
            }
            if (useCha == "") {
                useCha = small_alphabets + large_alphabets + number
            }
            return useCha;
        }
    </script>
</html>